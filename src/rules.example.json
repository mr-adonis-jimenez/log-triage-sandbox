[
  {
    "id": "errors-to-alerts",
    "where": { "level": ["error", "fatal"] },
    "action": { "bucket": "alerts", "addTag": ["needs-investigation"] }
  },
  {
    "id": "auth-service",
    "where": { "service": ["auth", "login"], "contains": ["unauthorized", "forbidden"] },
    "action": { "bucket": "auth-issues", "addTag": "security" }
  },
  {
    "id": "retryable",
    "where": { "contains": ["ETIMEDOUT", "ECONNRESET", "timeout", "retry"] },
    "action": { "bucket": "transient", "addTag": "network", "elevate": "warn" }
  },
  {
    "id": "drop-healthchecks",
    "where": { "regex": "health(check)?|heartbeat" },
    "action": { "drop": true, "addTag": "noise" }
  }
]
